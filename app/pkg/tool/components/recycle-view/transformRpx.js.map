{"version":3,"file":"transformRpx.js","sources":["../src/utils/transformRpx.ts"],"sourcesContent":["const BASE_DEVICE_WIDTH = 750;\n\nlet isIPhone = false;\nlet deviceWidth: number;\nlet deviceDPR: number;\n\nconst checkDeviceWidth = () => {\n  const info = wx.getSystemInfoSync();\n\n  const newDeviceWidth = info.screenWidth || 375;\n  const newDeviceDPR = info.pixelRatio || 2;\n\n  isIPhone = info.platform === \"ios\";\n\n  if (!isIPhone) {\n    // HACK switch width and height when landscape\n    // const newDeviceHeight = info.screenHeight || 375\n    // 暂时不处理转屏的情况\n  }\n\n  if (newDeviceWidth !== deviceWidth || newDeviceDPR !== deviceDPR) {\n    deviceWidth = newDeviceWidth;\n    deviceDPR = newDeviceDPR;\n  }\n};\n\ncheckDeviceWidth();\n\nconst eps = 1e-4;\n\nconst transformByDPR = (number) => {\n  if (number === 0) {\n    return 0;\n  }\n  number = (number / BASE_DEVICE_WIDTH) * deviceWidth;\n  number = Math.floor(number + eps);\n  if (number === 0) {\n    if (deviceDPR === 1 || !isIPhone) {\n      return 1;\n    }\n    return 0.5;\n  }\n  return number;\n};\n\nconst rpxRE = /([+-]?\\d+(?:\\.\\d+)?)rpx/gi;\n\nexport const transformRpx = (style, inline = false) => {\n  if (typeof style !== \"string\") {\n    return style;\n  }\n\n  return style.replace(\n    rpxRE,\n    (_, num) => transformByDPR(Number(num)) + (inline ? \"px\" : \"\"),\n  );\n};\n"],"names":["isIPhone","deviceWidth","deviceDPR","checkDeviceWidth","info","newDeviceWidth","newDeviceDPR","eps","transformByDPR","number","rpxRE","transformRpx","style","inline","_","num"],"mappings":"AAEA,IAAIA,EAAW,GACXC,EACAC,EAEJ,MAAMC,EAAmB,IAAM,CAC7B,MAAMC,EAAO,GAAG,kBAAA,EAEVC,EAAiBD,EAAK,aAAe,IACrCE,EAAeF,EAAK,YAAc,EAExCJ,EAAWI,EAAK,WAAa,OAQzBC,IAAmBJ,GAAeK,IAAiBJ,KACrDD,EAAcI,EACdH,EAAYI,EAEhB,EAEAH,IAEA,MAAMI,EAAM,KAENC,EAAkBC,GAClBA,IAAW,EACN,GAETA,EAAUA,EAAS,IAAqBR,EACxCQ,EAAS,KAAK,MAAMA,EAASF,CAAG,EAC5BE,IAAW,EACTP,IAAc,GAAK,CAACF,EACf,EAEF,GAEFS,GAGHC,EAAQ,4BAEDC,EAAe,CAACC,EAAOC,EAAS,KACvC,OAAOD,GAAU,SACZA,EAGFA,EAAM,QACXF,EACA,CAACI,EAAGC,IAAQP,EAAe,OAAOO,CAAG,CAAC,GAAKF,EAAS,KAAO,GAC7D"}