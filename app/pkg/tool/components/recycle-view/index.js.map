{"version":3,"file":"index.js","sources":["../src/utils/recycle-data.ts","../src/utils/viewport-change-func.ts","../src/utils/recycle-context.ts","../src/index.ts"],"sourcesContent":["export const recycleData: Record<string, unknown> = {};\n","/* eslint complexity: [\"error\", {\"max\": 50}] */\nimport { recycleData } from \"./recycle-data.js\";\n\nexport const viewPortChange = function (e, cb) {\n  const detail = e.detail;\n  // console.log('data change transfer use time', Date.now() - e.detail.timeStamp)\n  let newList = [];\n  const item = recycleData[detail.id];\n  // 边界值判断, 避免造成异常, 假设先调用了createRecycleContext, 然后再延迟2s调用append插入数据的情况\n  if (!item || !item.list) return;\n  const dataList = item.list;\n  const pos = detail.data;\n  const beginIndex = pos.beginIndex;\n  const endIndex = pos.endIndex;\n  item.pos = pos;\n  // 加ignoreBeginIndex和ignoreEndIndex\n  if (\n    typeof beginIndex === \"undefined\" ||\n    beginIndex === -1 ||\n    typeof endIndex === \"undefined\" ||\n    endIndex === -1\n  ) {\n    newList = [];\n  } else {\n    let i = -1;\n    for (i = beginIndex; i < dataList.length && i <= endIndex; i++) {\n      if (i >= pos.ignoreBeginIndex && i <= pos.ignoreEndIndex) continue;\n      newList.push(dataList[i]);\n    }\n  }\n  const obj = {\n    // batchSetRecycleData: !this.data.batchSetRecycleData\n  };\n  obj[item.key] = newList;\n  const comp = this.selectComponent(\"#\" + detail.id);\n  obj[comp.data.batchKey] = !this.data.batchSetRecycleData;\n  comp._setInnerBeforeAndAfterHeight({\n    beforeHeight: pos.minTop,\n    afterHeight: pos.afterHeight,\n  });\n  this.setData(obj, () => {\n    if (typeof cb === \"function\") {\n      cb();\n    }\n  });\n};\n","import { recycleData } from \"./recycle-data.js\";\nimport { viewPortChange } from \"./viewport-change-func.js\";\nimport { transformRpx } from \"./transformRpx.js\";\n\nconst RECT_SIZE = 200;\n\nfunction getValue(item, key) {\n  if (!key) return item;\n  if (typeof item[key] !== \"undefined\") return item[key];\n  const keyItems = key.split(\".\");\n  for (let i = 0; i < keyItems.length; i++) {\n    item = item[keyItems[i]];\n    if (typeof item === \"undefined\" || (typeof item === \"object\" && !item)) {\n      return undefined;\n    }\n  }\n  return item;\n}\n\nfunction getValues(item, keys) {\n  if (Object.prototype.toString.call(keys) !== \"[object Array]\") {\n    keys = [keys];\n  }\n  const vals = {};\n  for (let i = 0; i < keys.length; i++) {\n    vals[keys[i]] = getValue(item, keys[i]);\n  }\n  return vals;\n}\n\nfunction isArray(arr) {\n  return Object.prototype.toString.call(arr) === \"[object Array]\";\n}\n\nfunction isSamePureValue(item1, item2) {\n  if (typeof item1 !== typeof item2) return false;\n  if (isArray(item1) && isArray(item2)) {\n    if (item1.length !== item2.length) return false;\n    for (let i = 0; i < item1.length; i++) {\n      if (item1[i] !== item2[i]) return false;\n    }\n    return true;\n  }\n  return item1 === item2;\n}\n\nfunction isSameValue(item1, item2, keys) {\n  if (!isArray(keys)) {\n    keys = [keys];\n  }\n  for (let i = 0; i < keys.length; i++) {\n    if (!isSamePureValue(getValue(item1, keys[i]), getValue(item2, keys[i])))\n      return false;\n  }\n  return true;\n}\n\nexport interface SizeInfo {\n  width: number;\n  height: number;\n}\n\nexport type SizeGetter<T> = (item: T, index: number) => SizeInfo;\n\nexport interface RecycleContextOptions<T> {\n  id: string;\n  dataKey: string;\n  page:\n    | WechatMiniprogram.Component.Instance<\n        Record<string, any>,\n        Record<string, any>,\n        Record<string, any>\n      >\n    | WechatMiniprogram.Page.Instance<Record<string, any>, Record<string, any>>;\n  itemSize: SizeGetter<T> | SizeInfo;\n  useInPage?: boolean;\n  root?: WechatMiniprogram.Page.Instance<\n    Record<string, any>,\n    Record<string, any>\n  >;\n  placeholderClass?: string;\n}\n\n// eslint-disable-next-line no-complexity\nexport class RecycleContext<T> {\n  id: string;\n  dataKey: string;\n  page:\n    | WechatMiniprogram.Component.Instance<\n        Record<string, any>,\n        Record<string, any>,\n        Record<string, any>\n      >\n    | WechatMiniprogram.Page.Instance<Record<string, any>, Record<string, any>>;\n\n  comp:\n    | WechatMiniprogram.Component.Instance<\n        Record<string, any>,\n        Record<string, any>,\n        Record<string, any>\n      >\n    | undefined;\n\n  itemSize: SizeGetter<T> | SizeInfo;\n\n  itemSizeOpt: SizeGetter<T> | SizeInfo;\n\n  useInPage: boolean;\n\n  root:\n    | WechatMiniprogram.Page.Instance<Record<string, any>, Record<string, any>>\n    | undefined;\n\n  placeholderClass: string | undefined;\n\n  oldPageScroll?:\n    | ((\n        /** 页面滚动参数 */\n        options: WechatMiniprogram.Page.IPageScrollOption,\n      ) => void | Promise<void>)\n    | undefined;\n\n  isDataReady = false;\n\n  constructor({\n    id,\n    dataKey,\n    page,\n    itemSize,\n    useInPage,\n    placeholderClass,\n    root,\n  }: RecycleContextOptions<T>) {\n    if (!id || !dataKey || !page || !itemSize) {\n      throw new Error(\"parameter id, dataKey, page, itemSize is required\");\n    }\n\n    if (typeof itemSize !== \"function\" && typeof itemSize !== \"object\") {\n      throw new Error(\n        \"parameter itemSize must be function or object with key width and height\",\n      );\n    }\n\n    if (\n      typeof itemSize === \"object\" &&\n      (!itemSize.width || !itemSize.height) &&\n      (!itemSize.props || !itemSize.queryClass || !itemSize.dataKey)\n    ) {\n      throw new Error(\n        \"parameter itemSize must be function or object with key width and height\",\n      );\n    }\n    this.id = id;\n    this.dataKey = dataKey;\n    this.page = page;\n    // 加root参数给useInPage单独使用\n    this.root = root;\n    this.placeholderClass = placeholderClass;\n    page._recycleViewportChange = viewPortChange;\n    this.comp = page.selectComponent(\"#\" + id);\n    this.itemSize = itemSize;\n    this.itemSizeOpt = itemSize;\n    // if (!this.comp) {\n    // throw `<recycle-view> with id ${id} not found`\n    // }\n    this.useInPage = useInPage || false;\n\n    if (this.comp) {\n      this.comp.context = this;\n      this.comp.setPage(page);\n      this.comp.setUseInPage(this.useInPage);\n    }\n\n    if (this.useInPage && !this.root) {\n      throw new Error(\"parameter root is required when useInPage is true\");\n    }\n\n    if (this.useInPage) {\n      this.oldPageScroll = this.root!.onPageScroll;\n\n      // 重写onPageScroll事件\n      this.root!.onPageScroll = (e) => {\n        // this.checkComp();\n        if (this.comp) {\n          this.comp._scrollViewDidScroll({\n            detail: {\n              scrollLeft: 0,\n              scrollTop: e.scrollTop,\n            },\n          });\n        }\n        this.oldPageScroll?.apply(this.root, [e]);\n      };\n\n      this.oldReachBottom = this.root!.onReachBottom;\n\n      this.root!.onReachBottom = (e) => {\n        if (this.comp) {\n          this.comp.triggerEvent(\"scrolltolower\", {});\n        }\n        this.oldReachBottom.apply(this.root, [e]);\n      };\n      this.oldPullDownRefresh = this.root!.onPullDownRefresh;\n\n      this.root.onPullDownRefresh = (e) => {\n        if (this.comp) {\n          this.comp.triggerEvent(\"scrolltoupper\", {});\n        }\n\n        this.oldPullDownRefresh.apply(this.root, [e]);\n      };\n    }\n  }\n\n  checkComp() {\n    if (!this.comp) {\n      this.comp = this.page.selectComponent(\"#\" + this.id);\n      if (this.comp) {\n        this.comp.setUseInPage(this.useInPage);\n        this.comp.context = this;\n        this.comp.setPage(this.page);\n      } else {\n        throw new Error(\n          \"the recycle-view correspond to this context is detached, please create another RecycleContext\",\n        );\n      }\n    }\n  }\n\n  #forceRerender(id, cb) {\n    this.isDataReady = true; // 首次调用说明数据已经ready了\n\n    let allrect = null;\n    let parentRect = null;\n    let count = 0;\n\n    const setPlaceholderImage = () => {\n      if (!allrect || !parentRect) return;\n      const svgRects = [];\n      for (let i = 0; i < count; i++) {\n        svgRects.push({\n          left: allrect[i].left - parentRect.left,\n          top: allrect[i].top - parentRect.top,\n          width: allrect[i].width,\n          height: allrect[i].height,\n        });\n      }\n      this.comp!.setPlaceholderImage(svgRects, {\n        width: parentRect.width,\n        height: parentRect.height,\n      });\n    };\n\n    const newcb = () => {\n      if (cb) {\n        cb();\n      }\n      // 计算placeholder, 只有在动态计算高度的时候才支持\n      if (this.autoCalculateSize && this.placeholderClass) {\n        const newQueryClass = [];\n\n        this.placeholderClass.forEach((item) => {\n          newQueryClass.push(`.${this.itemSizeOpt.queryClass} .` + item);\n        });\n        // newQueryClass.push(`.` + that.itemSizeOpt.queryClass)\n        count = newQueryClass.length;\n        this.page\n          .createSelectorQuery()\n          .selectAll(newQueryClass.join(\",\"))\n          .boundingClientRect((rect) => {\n            if (rect.length < count) return;\n            allrect = rect;\n            setPlaceholderImage();\n          })\n          .exec();\n        this.page\n          .createSelectorQuery()\n          .select(\".\" + this.itemSizeOpt.queryClass)\n          .boundingClientRect((rect) => {\n            parentRect = rect;\n            setPlaceholderImage();\n          })\n          .exec();\n      }\n    };\n\n    if (\n      Object.prototype.toString.call(this.itemSizeOpt) === \"[object Object]\" &&\n      this.itemSizeOpt &&\n      !this.itemSizeOpt.width\n    ) {\n      this._recalculateSizeByProp(recycleData[id].list, function (sizeData) {\n        recycleData[id].sizeMap = sizeData.map;\n        recycleData[id].sizeArray = sizeData.array;\n        // 触发强制渲染\n        this.comp.forceUpdate(newcb);\n      });\n      return;\n    }\n    const sizeData = this._recalculateSize(recycleData[id].list);\n    recycleData[id].sizeMap = sizeData.map;\n    // console.log('size is', sizeData.array, sizeData.map, 'totalHeight', sizeData.totalHeight)\n    // console.log('sizeArray', sizeData.array)\n    recycleData[id].sizeArray = sizeData.array;\n    // 触发强制渲染\n    this.comp.forceUpdate(cb);\n  }\n\n  _recalculateSizeByProp(list, cb) {\n    const itemSize = this.itemSizeOpt;\n    let propValueMap = this.propValueMap || [];\n    const calcNewItems = [];\n    const needCalcPropIndex = [];\n    if (itemSize.cacheKey) {\n      propValueMap = wx.getStorageSync(itemSize.cacheKey) || [];\n      // eslint-disable-next-line no-console\n      // console.log('[recycle-view] get itemSize from cache', propValueMap)\n    }\n    this.autoCalculateSize = true;\n    const item2PropValueMap = [];\n    for (let i = 0; i < list.length; i++) {\n      let item2PropValueIndex = propValueMap.length;\n      if (!propValueMap.length) {\n        const val = getValues(list[i], itemSize.props);\n        val.__index__ = i;\n        propValueMap.push(val);\n        calcNewItems.push(list[i]);\n        needCalcPropIndex.push(item2PropValueIndex);\n        item2PropValueMap.push({\n          index: i,\n          sizeIndex: item2PropValueIndex,\n        });\n        continue;\n      }\n      let found = false;\n      for (let j = 0; j < propValueMap.length; j++) {\n        if (isSameValue(propValueMap[j], list[i], itemSize.props)) {\n          item2PropValueIndex = j;\n          found = true;\n          break;\n        }\n      }\n      if (!found) {\n        const val = getValues(list[i], itemSize.props);\n        val.__index__ = i;\n        propValueMap.push(val);\n        calcNewItems.push(list[i]);\n        needCalcPropIndex.push(item2PropValueIndex);\n      }\n      item2PropValueMap.push({\n        index: i,\n        sizeIndex: item2PropValueIndex,\n      });\n    }\n    // this.item2PropValueMap = item2PropValueMap\n    this.propValueMap = propValueMap;\n    if (propValueMap.length > 10) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        \"[recycle-view] get itemSize count exceed maximum of 10, now got\",\n        propValueMap,\n      );\n    }\n    // console.log('itemsize', propValueMap, item2PropValueMap)\n    // 预先渲染\n    const that = this;\n    function newItemSize(item, index) {\n      const sizeIndex = item2PropValueMap[index];\n      if (!sizeIndex) {\n        // eslint-disable-next-line no-console\n        console.error(\n          \"[recycle-view] auto calculate size array error, no map size found\",\n          item,\n          index,\n          item2PropValueMap,\n        );\n        throw new Error(\n          \"[recycle-view] auto calculate size array error, no map size found\",\n        );\n      }\n      const size = propValueMap[sizeIndex.sizeIndex];\n      if (!size) {\n        // eslint-disable-next-line no-console\n        console.log(\n          \"[recycle-view] auto calculate size array error, no size found\",\n          item,\n          index,\n          sizeIndex,\n          propValueMap,\n        );\n        throw new Error(\n          \"[recycle-view] auto calculate size array error, no size found\",\n        );\n      }\n      return {\n        width: size.width,\n        height: size.height,\n      };\n    }\n    function sizeReady(rects) {\n      rects.forEach((rect, index) => {\n        const propValueIndex = needCalcPropIndex[index];\n        propValueMap[propValueIndex].width = rect.width;\n        propValueMap[propValueIndex].height = rect.height;\n      });\n      that.itemSize = newItemSize;\n      const sizeData = that._recalculateSize(list);\n      if (itemSize.cacheKey) {\n        wx.setStorageSync(itemSize.cacheKey, propValueMap); // 把数据缓存起来\n      }\n      if (cb) {\n        cb(sizeData);\n      }\n    }\n    if (calcNewItems.length) {\n      const obj = {};\n      obj[itemSize.dataKey] = calcNewItems;\n      this.page.setData(obj, () => {\n        this.page\n          .createSelectorQuery()\n          .selectAll(\".\" + itemSize.queryClass)\n          .boundingClientRect((rects) => {\n            sizeReady(rects);\n          })\n          .exec();\n      });\n    } else {\n      that.itemSize = newItemSize;\n      const sizeData = that._recalculateSize(list);\n      if (cb) {\n        cb(sizeData);\n      }\n    }\n  }\n\n  // 当before和after这2个slot发生变化的时候调用一下此接口\n  _recalculateSize(list) {\n    // 遍历所有的数据\n    // 应该最多就千量级的, 遍历没有问题\n    const sizeMap = {};\n    const func = this.itemSize;\n    const funcExist = typeof func === \"function\";\n    const comp = this.comp;\n\n    const compData = comp.data;\n    let offsetLeft = 0;\n    let offsetTop = 0;\n    let line = 0;\n    let column = 0;\n    const sizeArray = [];\n    const listLen = list.length;\n    // 把整个页面拆分成200*200的很多个方格, 判断每个数据落在哪个方格上\n    for (let i = 0; i < listLen; i++) {\n      list[i].__index__ = i;\n      let itemSize = {};\n      // 获取到每一项的宽和高\n      if (funcExist) {\n        // 必须保证返回的每一行的高度一样\n        itemSize = func && func.call(this, list[i], i);\n      } else {\n        itemSize = {\n          width: func.width,\n          height: func.height,\n        };\n      }\n      itemSize = Object.assign({}, itemSize);\n      sizeArray.push(itemSize);\n      // 判断数据落到哪个方格上\n      // 超过了宽度, 移动到下一行, 再根据高度判断是否需要移动到下一个方格\n      if (offsetLeft + itemSize.width > compData.width) {\n        column = 0;\n        offsetLeft = itemSize.width;\n        // Fixed issue #22\n        if (sizeArray.length >= 2) {\n          offsetTop += sizeArray[sizeArray.length - 2].height || 0; // 加上最后一个数据的高度\n        } else {\n          offsetTop += itemSize.height;\n        }\n        // offsetTop += sizeArray[sizeArray.length - 2].height // 加上最后一个数据的高度\n        // 根据高度判断是否需要移动到下一个方格\n        if (offsetTop >= RECT_SIZE * (line + 1)) {\n          // fix: 当区块比较大时，会缺失块区域信息\n          const lastIdx = i - 1;\n          const lastLine = line;\n\n          line += parseInt((offsetTop - RECT_SIZE * line) / RECT_SIZE, 10);\n\n          for (let idx = lastLine; idx < line; idx++) {\n            const key = `${idx}.${column}`;\n            if (!sizeMap[key]) {\n              sizeMap[key] = [];\n            }\n            sizeMap[key].push(lastIdx);\n          }\n        }\n\n        // 新起一行的元素, beforeHeight是前一个元素的beforeHeight和height相加\n        if (i === 0) {\n          itemSize.beforeHeight = 0;\n        } else {\n          const prevItemSize = sizeArray[sizeArray.length - 2];\n          itemSize.beforeHeight =\n            prevItemSize.beforeHeight + prevItemSize.height;\n        }\n      } else {\n        if (offsetLeft >= RECT_SIZE * (column + 1)) {\n          column++;\n        }\n        offsetLeft += itemSize.width;\n        if (i === 0) {\n          itemSize.beforeHeight = 0;\n        } else {\n          // 同一行的元素, beforeHeight和前面一个元素的beforeHeight一样\n          itemSize.beforeHeight = sizeArray[sizeArray.length - 2].beforeHeight;\n        }\n      }\n      const key = `${line}.${column}`;\n      if (!sizeMap[key]) {\n        sizeMap[key] = [];\n      }\n      sizeMap[key].push(i);\n\n      // fix: 当区块比较大时，会缺失块区域信息\n      if (listLen - 1 === i && itemSize.height > RECT_SIZE) {\n        const lastIdx = line;\n        offsetTop += itemSize.height;\n        line += parseInt((offsetTop - RECT_SIZE * line) / RECT_SIZE, 10);\n        for (let idx = lastIdx; idx <= line; idx++) {\n          const key = `${idx}.${column}`;\n          if (!sizeMap[key]) {\n            sizeMap[key] = [];\n          }\n          sizeMap[key].push(i);\n        }\n      }\n    }\n    // console.log('sizeMap', sizeMap)\n    const obj = {\n      array: sizeArray,\n      map: sizeMap,\n      totalHeight: sizeArray.length\n        ? sizeArray[sizeArray.length - 1].beforeHeight +\n          sizeArray[sizeArray.length - 1].height\n        : 0,\n    };\n    comp.setItemSize(obj);\n    return obj;\n  }\n\n  deleteList(beginIndex, count, cb) {\n    this.checkComp();\n    const id = this.id;\n    if (!recycleData[id]) {\n      return this;\n    }\n    recycleData[id].list.splice(beginIndex, count);\n    this.#forceRerender(id, cb);\n    return this;\n  }\n  updateList(beginIndex, list, cb) {\n    this.checkComp();\n    const id = this.id;\n    if (!recycleData[id]) {\n      return this;\n    }\n    const len = recycleData[id].list.length;\n    for (let i = 0; i < list.length && beginIndex < len; i++) {\n      recycleData[id].list[beginIndex++] = list[i];\n    }\n    this.#forceRerender(id, cb);\n    return this;\n  }\n\n  update(...args) {\n    this.updateList(...args);\n  }\n\n  splice(begin, deleteCount, appendList, cb) {\n    this.checkComp();\n    const id = this.id;\n    const dataKey = this.dataKey;\n    // begin是数组\n    if (typeof begin === \"object\" && begin.length) {\n      cb = deleteCount;\n      appendList = begin;\n    }\n    if (typeof appendList === \"function\") {\n      cb = appendList;\n      appendList = [];\n    }\n    if (!recycleData[id]) {\n      recycleData[id] = {\n        key: dataKey,\n        id,\n        list: appendList || [],\n        sizeMap: {},\n        sizeArray: [],\n      };\n    } else {\n      recycleData[id].dataKey = dataKey;\n      const list = recycleData[id].list;\n      if (appendList && appendList.length) {\n        list.splice(begin, deleteCount, ...appendList);\n      } else {\n        list.splice(begin, deleteCount);\n      }\n    }\n    this.#forceRerender(id, cb);\n    return this;\n  }\n\n  append(list, cb) {\n    this.checkComp();\n\n    const id = this.id;\n    const dataKey = this.dataKey;\n    if (!recycleData[id]) {\n      recycleData[id] = {\n        key: dataKey,\n        id,\n        list,\n        sizeMap: {},\n        sizeArray: [],\n      };\n    } else {\n      recycleData[id].dataKey = dataKey;\n      recycleData[id].list = recycleData[id].list.concat(list);\n    }\n    this.#forceRerender(id, cb);\n\n    return this;\n  }\n\n  destroy() {\n    if (this.useInPage) {\n      this.page.onPullDownRefresh = this.oldPullDownRefresh;\n      this.page.onReachBottom = this.oldReachBottom;\n      this.page.onPageScroll = this.oldPageScroll;\n      this.oldPageScroll = this.oldReachBottom = this.oldPullDownRefresh = null;\n    }\n    this.page = null;\n    this.comp = null;\n    if (recycleData[this.id]) {\n      delete recycleData[this.id];\n    }\n    return this;\n  }\n\n  // 重新更新下页面的数据\n  forceUpdate(cb, reinitSlot) {\n    this.checkComp();\n    if (reinitSlot) {\n      this.comp.reRender(() => {\n        this.#forceRerender(this.id, cb);\n      });\n    } else {\n      this.#forceRerender(this.id, cb);\n    }\n    return this;\n  }\n\n  getBoundingClientRect(index) {\n    this.checkComp();\n    if (!recycleData[this.id]) {\n      return null;\n    }\n    const sizeArray = recycleData[this.id]!.sizeArray;\n    if (!sizeArray || !sizeArray.length) {\n      return null;\n    }\n    if (typeof index === \"undefined\") {\n      const list = [];\n      for (let i = 0; i < sizeArray.length; i++) {\n        list.push({\n          left: 0,\n          top: sizeArray[i].beforeHeight,\n          width: sizeArray[i].width,\n          height: sizeArray[i].height,\n        });\n      }\n      return list;\n    }\n    index = parseInt(index, 10);\n    if (index >= sizeArray.length || index < 0) return null;\n    return {\n      left: 0,\n      top: sizeArray[index].beforeHeight,\n      width: sizeArray[index].width,\n      height: sizeArray[index].height,\n    };\n  }\n  getScrollTop() {\n    this.checkComp();\n    return this.comp!.currentScrollTop || 0;\n  }\n\n  // 将px转化为rpx\n  transformRpx(str, addPxSuffix: boolean) {\n    if (typeof str === \"number\") str += \"rpx\";\n    return parseFloat(transformRpx(str, addPxSuffix));\n  }\n\n  getViewportItems(inViewportPx) {\n    this.checkComp();\n    const indexes = this.comp!.getIndexesInViewport(inViewportPx);\n    if (indexes.length <= 0) return [];\n    const viewportItems = [];\n    const list = recycleData[this.id].list;\n    for (let i = 0; i < indexes.length; i++) {\n      viewportItems.push(list[indexes[i]]);\n    }\n    return viewportItems;\n  }\n\n  getTotalHeight() {\n    this.checkComp();\n    return this.comp!.getTotalHeight();\n  }\n\n  // 返回完整的列表数据\n  getList() {\n    if (!recycleData[this.id]) {\n      return [];\n    }\n    return recycleData[this.id].list;\n  }\n}\n","/**\n * recycle-view 组件的 API 使用\n * 提供 wx.createRecycleContext 进行管理功能\n */\nimport { RecycleContext } from \"./utils/recycle-context.js\";\n\n/**\n * @params options 参数是 object 对象，展开的结构如下\n      id: recycle-view 的 id\n      dataKey: recycle-item 的 wx:for 绑定的数据变量\n      page: recycle-view 所在的页面或组件的实例\n      itemSize: 函数或者是 object 对象，生成每个 recycle-item 的宽和高\n * @return RecycleContext 对象\n */\nexport const createRecycleContext = (options) => new RecycleContext(options);\n"],"names":["recycleData","viewPortChange","e","cb","detail","newList","item","dataList","pos","beginIndex","endIndex","i","obj","comp","_RecycleContext_instances","forceRerender_fn","RECT_SIZE","getValue","key","keyItems","getValues","keys","vals","isArray","arr","isSamePureValue","item1","item2","isSameValue","RecycleContext","id","dataKey","page","itemSize","useInPage","placeholderClass","root","__privateAdd","_a","list","propValueMap","calcNewItems","needCalcPropIndex","item2PropValueMap","item2PropValueIndex","val","found","j","that","newItemSize","index","sizeIndex","size","sizeReady","rects","rect","propValueIndex","sizeData","sizeMap","func","funcExist","compData","offsetLeft","offsetTop","line","column","sizeArray","listLen","lastIdx","lastLine","idx","prevItemSize","count","__privateMethod","len","args","begin","deleteCount","appendList","reinitSlot","str","addPxSuffix","transformRpx","inViewportPx","indexes","viewportItems","allrect","parentRect","setPlaceholderImage","svgRects","newcb","newQueryClass","createRecycleContext","options"],"mappings":"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"}