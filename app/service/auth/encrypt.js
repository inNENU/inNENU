const ot=()=>Math.floor(Math.random()*Math.pow(2,32)),C={},M=C.lib={},w=M.Base={extend:function(t){const e=Object.create(this);return t&&e.mixIn(t),(!e.hasOwnProperty("init")||this.init===e.init)&&(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){const t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(const e in t)t.hasOwnProperty(e)&&(this[e]=t[e])},clone:function(){return this.init.prototype.extend(this)}};var z=M.WordArray=w.extend({init:function(t,e){t=this.words=t||[],e!=null?this.sigBytes=e:this.sigBytes=t.length*4},toString:function(t){return(t||ct).stringify(this)},concat:function(t){const e=this.words,i=t.words,n=this.sigBytes,s=t.sigBytes;if(this.clamp(),n%4)for(let r=0;r<s;r++){const l=i[r>>>2]>>>24-r%4*8&255;e[n+r>>>2]|=l<<24-(n+r)%4*8}else for(let r=0;r<s;r+=4)e[n+r>>>2]=i[r>>>2];return this.sigBytes+=s,this},clamp:function(){const t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=Math.ceil(e/4)},clone:function(){const t=w.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){const e=[];for(let i=0;i<t;i+=4)e.push(ot());return new z.init(e,t)}});const P=C.enc={};var ct=P.Hex={stringify:function(t){const e=t.words,i=t.sigBytes,n=[];for(let s=0;s<i;s++){const r=e[s>>>2]>>>24-s%4*8&255;n.push((r>>>4).toString(16)),n.push((r&15).toString(16))}return n.join("")},parse:function(t){const e=t.length,i=[];for(let n=0;n<e;n+=2)i[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new z.init(i,e/2)}};const Q=P.Latin1={stringify:function(t){const e=t.words,i=t.sigBytes,n=[];for(let s=0;s<i;s++){const r=e[s>>>2]>>>24-s%4*8&255;n.push(String.fromCharCode(r))}return n.join("")},parse:function(t){const e=t.length,i=[];for(let n=0;n<e;n++)i[n>>>2]|=(t.charCodeAt(n)&255)<<24-n%4*8;return new z.init(i,e)}},K=P.Utf8={stringify:function(t){try{return decodeURIComponent(escape(Q.stringify(t)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(t){return Q.parse(unescape(encodeURIComponent(t)))}},H=M.BufferedBlockAlgorithm=w.extend({reset:function(){this._data=new z.init,this._nDataBytes=0},_append:function(t){typeof t=="string"&&(t=K.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){let e;const i=this._data,n=i.words,s=i.sigBytes,r=this.blockSize,l=r*4;let f=s/l;t?f=Math.ceil(f):f=Math.max((f|0)-this._minBufferSize,0);const d=f*r,p=Math.min(d*4,s);if(d){for(let _=0;_<d;_+=r)this._doProcessBlock(n,_);e=n.splice(0,d),i.sigBytes-=p}return new z.init(e,p)},clone:function(){const t=w.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),Y=M.Hasher=H.extend({cfg:w.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){H.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:512/32,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new I.HMAC.init(t,i).finalize(e)}}});var I=C.algo={};function at(t,e,i){const n=[];let s=0;for(let r=0;r<e;r++)if(r%4){const l=i[t.charCodeAt(r-1)]<<r%4*2,f=i[t.charCodeAt(r)]>>>6-r%4*2,d=l|f;n[s>>>2]|=d<<24-s%4*8,s++}return z.create(n,s)}const Z=P.Base64={stringify:function(t){const e=t.words,i=t.sigBytes,n=this._map;t.clamp();const s=[];for(let l=0;l<i;l+=3){const f=e[l>>>2]>>>24-l%4*8&255,d=e[l+1>>>2]>>>24-(l+1)%4*8&255,p=e[l+2>>>2]>>>24-(l+2)%4*8&255,_=f<<16|d<<8|p;for(let y=0;y<4&&l+y*.75<i;y++)s.push(n.charAt(_>>>6*(3-y)&63))}const r=n.charAt(64);if(r)for(;s.length%4;)s.push(r);return s.join("")},parse:function(t){let e=t.length;const i=this._map;let n=this._reverseMap;if(!n){n=this._reverseMap=[];for(let r=0;r<i.length;r++)n[i.charCodeAt(r)]=r}const s=i.charAt(64);if(s){const r=t.indexOf(s);r!==-1&&(e=r)}return at(t,e,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},u=[];for(let t=0;t<64;t++)u[t]=Math.abs(Math.sin(t+1))*4294967296|0;const ht=I.MD5=Y.extend({_doReset:function(){this._hash=new z.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(let j=0;j<16;j++){const J=e+j,b=t[J];t[J]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360}const i=this._hash.words,n=t[e+0],s=t[e+1],r=t[e+2],l=t[e+3],f=t[e+4],d=t[e+5],p=t[e+6],_=t[e+7],y=t[e+8],x=t[e+9],S=t[e+10],F=t[e+11],E=t[e+12],D=t[e+13],O=t[e+14],R=t[e+15];let o=i[0],c=i[1],a=i[2],h=i[3];o=g(o,c,a,h,n,7,u[0]),h=g(h,o,c,a,s,12,u[1]),a=g(a,h,o,c,r,17,u[2]),c=g(c,a,h,o,l,22,u[3]),o=g(o,c,a,h,f,7,u[4]),h=g(h,o,c,a,d,12,u[5]),a=g(a,h,o,c,p,17,u[6]),c=g(c,a,h,o,_,22,u[7]),o=g(o,c,a,h,y,7,u[8]),h=g(h,o,c,a,x,12,u[9]),a=g(a,h,o,c,S,17,u[10]),c=g(c,a,h,o,F,22,u[11]),o=g(o,c,a,h,E,7,u[12]),h=g(h,o,c,a,D,12,u[13]),a=g(a,h,o,c,O,17,u[14]),c=g(c,a,h,o,R,22,u[15]),o=m(o,c,a,h,s,5,u[16]),h=m(h,o,c,a,p,9,u[17]),a=m(a,h,o,c,F,14,u[18]),c=m(c,a,h,o,n,20,u[19]),o=m(o,c,a,h,d,5,u[20]),h=m(h,o,c,a,S,9,u[21]),a=m(a,h,o,c,R,14,u[22]),c=m(c,a,h,o,f,20,u[23]),o=m(o,c,a,h,x,5,u[24]),h=m(h,o,c,a,O,9,u[25]),a=m(a,h,o,c,l,14,u[26]),c=m(c,a,h,o,y,20,u[27]),o=m(o,c,a,h,D,5,u[28]),h=m(h,o,c,a,r,9,u[29]),a=m(a,h,o,c,_,14,u[30]),c=m(c,a,h,o,E,20,u[31]),o=v(o,c,a,h,d,4,u[32]),h=v(h,o,c,a,y,11,u[33]),a=v(a,h,o,c,F,16,u[34]),c=v(c,a,h,o,O,23,u[35]),o=v(o,c,a,h,s,4,u[36]),h=v(h,o,c,a,f,11,u[37]),a=v(a,h,o,c,_,16,u[38]),c=v(c,a,h,o,S,23,u[39]),o=v(o,c,a,h,D,4,u[40]),h=v(h,o,c,a,n,11,u[41]),a=v(a,h,o,c,l,16,u[42]),c=v(c,a,h,o,p,23,u[43]),o=v(o,c,a,h,x,4,u[44]),h=v(h,o,c,a,E,11,u[45]),a=v(a,h,o,c,R,16,u[46]),c=v(c,a,h,o,r,23,u[47]),o=k(o,c,a,h,n,6,u[48]),h=k(h,o,c,a,_,10,u[49]),a=k(a,h,o,c,O,15,u[50]),c=k(c,a,h,o,d,21,u[51]),o=k(o,c,a,h,E,6,u[52]),h=k(h,o,c,a,l,10,u[53]),a=k(a,h,o,c,S,15,u[54]),c=k(c,a,h,o,s,21,u[55]),o=k(o,c,a,h,y,6,u[56]),h=k(h,o,c,a,R,10,u[57]),a=k(a,h,o,c,p,15,u[58]),c=k(c,a,h,o,D,21,u[59]),o=k(o,c,a,h,f,6,u[60]),h=k(h,o,c,a,F,10,u[61]),a=k(a,h,o,c,r,15,u[62]),c=k(c,a,h,o,x,21,u[63]),i[0]=i[0]+o|0,i[1]=i[1]+c|0,i[2]=i[2]+a|0,i[3]=i[3]+h|0},_doFinalize:function(){const t=this._data,e=t.words,i=this._nDataBytes*8,n=t.sigBytes*8;e[n>>>5]|=128<<24-n%32;const s=Math.floor(i/4294967296),r=i;e[(n+64>>>9<<4)+15]=(s<<8|s>>>24)&16711935|(s<<24|s>>>8)&4278255360,e[(n+64>>>9<<4)+14]=(r<<8|r>>>24)&16711935|(r<<24|r>>>8)&4278255360,t.sigBytes=(e.length+1)*4,this._process();const l=this._hash,f=l.words;for(let d=0;d<4;d++){const p=f[d];f[d]=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360}return l},clone:function(){const t=Y.clone.call(this);return t._hash=this._hash.clone(),t}});function g(t,e,i,n,s,r,l){const f=t+(e&i|~e&n)+s+l;return(f<<r|f>>>32-r)+e}function m(t,e,i,n,s,r,l){const f=t+(e&n|i&~n)+s+l;return(f<<r|f>>>32-r)+e}function v(t,e,i,n,s,r,l){const f=t+(e^i^n)+s+l;return(f<<r|f>>>32-r)+e}function k(t,e,i,n,s,r,l){const f=t+(i^(e|~n))+s+l;return(f<<r|f>>>32-r)+e}const N=I.EvpKDF=w.extend({cfg:w.extend({keySize:128/32,hasher:ht,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){let i;const n=this.cfg,s=n.hasher.create(),r=z.create(),l=r.words,f=n.keySize,d=n.iterations;for(;l.length<f;){i&&s.update(i),i=s.update(t).finalize(e),s.reset();for(let p=1;p<d;p++)i=s.finalize(i),s.reset();r.concat(i)}return r.sigBytes=f*4,r}});C.EvpKDF=function(t,e,i){return N.create(i).compute(t,e)};const X=M.Cipher=H.extend({cfg:w.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,i){this.cfg=this.cfg.extend(i),this._xformMode=t,this._key=e,this.reset()},reset:function(){H.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function t(e){return typeof e=="string"?mt:A}return function(e){return{encrypt:function(i,n,s){return t(n).encrypt(e,i,n,s)},decrypt:function(i,n,s){return t(n).decrypt(e,i,n,s)}}}}()});M.StreamCipher=X.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});const ft=C.mode={},ut=M.BlockCipherMode=w.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}}),lt=ft.CBC=function(){const t=ut.extend();t.Encryptor=t.extend({processBlock:function(i,n){const s=this._cipher,r=s.blockSize;e.call(this,i,n,r),s.encryptBlock(i,n),this._prevBlock=i.slice(n,n+r)}}),t.Decryptor=t.extend({processBlock:function(i,n){const s=this._cipher,r=s.blockSize,l=i.slice(n,n+r);s.decryptBlock(i,n),e.call(this,i,n,r),this._prevBlock=l}});function e(i,n,s){let r;const l=this._iv;l?(r=l,this._iv=void 0):r=this._prevBlock;for(let f=0;f<s;f++)i[n+f]^=r[f]}return t}(),dt=C.pad={},$=dt.Pkcs7={pad:function(t,e){const i=e*4,n=i-t.sigBytes%i,s=n<<24|n<<16|n<<8|n,r=[];for(let f=0;f<n;f+=4)r.push(s);const l=z.create(r,n);t.concat(l)},unpad:function(t){const e=t.words[t.sigBytes-1>>>2]&255;t.sigBytes-=e}};var q=M.BlockCipher=X.extend({cfg:X.cfg.extend({mode:lt,padding:$}),reset:function(){let t;X.reset.call(this);const e=this.cfg,i=e.iv,n=e.mode;this._xformMode==this._ENC_XFORM_MODE?t=n.createEncryptor:(t=n.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==t?this._mode.init(this,i&&i.words):(this._mode=t.call(n,this,i&&i.words),this._mode.__creator=t)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){let t;const e=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(e.pad(this._data,this.blockSize),t=this._process(!0)):(t=this._process(!0),e.unpad(t)),t},blockSize:128/32});const U=M.CipherParams=w.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),pt=C.format={},_t=pt.OpenSSL={stringify:function(t){let e;const i=t.ciphertext,n=t.salt;return n?e=z.create([1398893684,1701076831]).concat(n).concat(i):e=i,e.toString(Z)},parse:function(t){let e;const i=Z.parse(t),n=i.words;return n[0]==1398893684&&n[1]==1701076831&&(e=z.create(n.slice(2,4)),n.splice(0,4),i.sigBytes-=16),U.create({ciphertext:i,salt:e})}};var A=M.SerializableCipher=w.extend({cfg:w.extend({format:_t}),encrypt:function(t,e,i,n){n=this.cfg.extend(n);const s=t.createEncryptor(i,n),r=s.finalize(e),l=s.cfg;return U.create({ciphertext:r,key:i,iv:l.iv,algorithm:t,mode:l.mode,padding:l.padding,blockSize:t.blockSize,formatter:n.format})},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),t.createDecryptor(i,n).finalize(e.ciphertext)},_parse:function(t,e){return typeof t=="string"?e.parse(t,this):t}});const yt=C.kdf={},gt=yt.OpenSSL={execute:function(t,e,i,n,s){if(n||(n=z.random(64/8)),s)var r=N.create({keySize:e+i,hasher:s}).compute(t,n);else var r=N.create({keySize:e+i}).compute(t,n);const l=z.create(r.words.slice(e),i*4);return r.sigBytes=e*4,U.create({key:r,iv:l,salt:n})}};var mt=M.PasswordBasedCipher=A.extend({cfg:A.cfg.extend({kdf:gt}),encrypt:function(t,e,i,n){n=this.cfg.extend(n);const s=n.kdf.execute(i,t.keySize,t.ivSize,n.salt,n.hasher);n.iv=s.iv;const r=A.encrypt.call(this,t,e,s.key,n);return r.mixIn(s),r},decrypt:function(t,e,i,n){n=this.cfg.extend(n),e=this._parse(e,n.format);const s=n.kdf.execute(i,t.keySize,t.ivSize,e.salt,n.hasher);return n.iv=s.iv,A.decrypt.call(this,t,e,s.key,n)}}),B=[],V=[],tt=[],et=[],nt=[],it=[],L=[],T=[],W=[],G=[];(function(){for(var t=[],e=0;e<256;e++)e<128?t[e]=e<<1:t[e]=e<<1^283;for(var i=0,n=0,e=0;e<256;e++){var s=n^n<<1^n<<2^n<<3^n<<4;s=s>>>8^s&255^99,B[i]=s,V[s]=i;var r=t[i],l=t[r],f=t[l],d=t[s]*257^s*16843008;tt[i]=d<<24|d>>>8,et[i]=d<<16|d>>>16,nt[i]=d<<8|d>>>24,it[i]=d;var d=f*16843009^l*65537^r*257^i*16843008;L[s]=d<<24|d>>>8,T[s]=d<<16|d>>>16,W[s]=d<<8|d>>>24,G[s]=d,i?(i=r^t[t[t[f^r]]],n^=t[t[n]]):i=n=1}})();var vt=[0,1,2,4,8,16,32,64,128,27,54],kt=I.AES=q.extend({_doReset:function(){var t;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var e=this._keyPriorReset=this._key,i=e.words,n=e.sigBytes/4,s=this._nRounds=n+6,r=(s+1)*4,l=this._keySchedule=[],f=0;f<r;f++)f<n?l[f]=i[f]:(t=l[f-1],f%n?n>6&&f%n==4&&(t=B[t>>>24]<<24|B[t>>>16&255]<<16|B[t>>>8&255]<<8|B[t&255]):(t=t<<8|t>>>24,t=B[t>>>24]<<24|B[t>>>16&255]<<16|B[t>>>8&255]<<8|B[t&255],t^=vt[f/n|0]<<24),l[f]=l[f-n]^t);for(var d=this._invKeySchedule=[],p=0;p<r;p++){var f=r-p;if(p%4)var t=l[f];else var t=l[f-4];p<4||f<=4?d[p]=t:d[p]=L[B[t>>>24]]^T[B[t>>>16&255]]^W[B[t>>>8&255]]^G[B[t&255]]}}},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,tt,et,nt,it,B)},decryptBlock:function(t,e){var i=t[e+1];t[e+1]=t[e+3],t[e+3]=i,this._doCryptBlock(t,e,this._invKeySchedule,L,T,W,G,V);var i=t[e+1];t[e+1]=t[e+3],t[e+3]=i},_doCryptBlock:function(t,e,i,n,s,r,l,f){for(var d=this._nRounds,p=t[e]^i[0],_=t[e+1]^i[1],y=t[e+2]^i[2],x=t[e+3]^i[3],S=4,F=1;F<d;F++){var E=n[p>>>24]^s[_>>>16&255]^r[y>>>8&255]^l[x&255]^i[S++],D=n[_>>>24]^s[y>>>16&255]^r[x>>>8&255]^l[p&255]^i[S++],O=n[y>>>24]^s[x>>>16&255]^r[p>>>8&255]^l[_&255]^i[S++],R=n[x>>>24]^s[p>>>16&255]^r[_>>>8&255]^l[y&255]^i[S++];p=E,_=D,y=O,x=R}var E=(f[p>>>24]<<24|f[_>>>16&255]<<16|f[y>>>8&255]<<8|f[x&255])^i[S++],D=(f[_>>>24]<<24|f[y>>>16&255]<<16|f[x>>>8&255]<<8|f[p&255])^i[S++],O=(f[y>>>24]<<24|f[x>>>16&255]<<16|f[p>>>8&255]<<8|f[_&255])^i[S++],R=(f[x>>>24]<<24|f[p>>>16&255]<<16|f[_>>>8&255]<<8|f[y&255])^i[S++];t[e]=E,t[e+1]=D,t[e+2]=O,t[e+3]=R},keySize:256/32});C.AES=q._createHelper(kt);const rt="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",xt=rt.length,st=t=>Array(t).fill(null).map(()=>rt.charAt(Math.floor(Math.random()*xt))).join(""),Bt=(t,e)=>{const i=st(64)+t,n=K.parse(e),s=K.parse(st(16));return C.AES.encrypt(i,n,{iv:s,padding:$}).toString()};export{Bt as authEncrypt};
//# sourceMappingURL=encrypt.js.map
